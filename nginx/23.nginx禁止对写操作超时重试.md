

nginx禁止对写操作超时重试
===============
> 2017-07-09


2016年的案例

支付那边说一笔请求从nginx端发送给后端tomcat了2次(落在两个不同的tomcat节点上)。

后来发现是nginx发现后端节点timeout(默认多少秒？)，然后做了重试，发给了另一个节点。

默认情况下nginx对后端error和timeout都会做retry，可以明确地禁止在timeout的情况下禁止retry。

当然如果**集群读写分离**的话，对于只读集群retry是无所谓的，但对于写确实存在问题。
(视具体情况而定，如果读耗时较长，重试就得不偿失。)

