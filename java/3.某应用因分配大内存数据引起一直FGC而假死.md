

某应用因分配大量数据内存引起一直FGC而假死
======================
> 2017-06-02


## 1.现象
应用进程在，在0:20之后没有任何日志输出。


## 2.分析
- 1、`top`查看CPU使用情况，CPU使用100%，内存使用60%
- 2、`top -Hc`查询最耗CPU的线程，发现是GC线程(arthas、greys)
- 3、查询了一下*Java线程栈*情况，发现所有线程都处于`BLOCKED`状态
- 4、查询*Java的垃圾回收*情况(`jstat -gcutil XXXX 2000 10`)，发现系统一直在GC、FGC
- 5、dump对象情况(`jmap -dump:format=b,file=dump.bin XXX`)
- 6、通过`MAT分析dump文件`，发现占用内存最大的对象，并分析出具体业务代码
- 7、经过业务方分析，发现这个方法一次性查询了20多万数据，然后就导致了系统一直GC


## 3.解决
- 业务方优化代码解决

